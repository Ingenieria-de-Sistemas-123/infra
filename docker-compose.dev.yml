services:

  permission-service:
    image: ghcr.io/ingenieria-de-sistemas-123/permission-service:dev
    container_name: permission-service
    ports:
      - "8080:8080"
    environment:
      - SPRING_DATASOURCE_URL=${SPRING_DATASOURCE_URL_PERMISSIONDB}
      - SPRING_DATASOURCE_USERNAME=${SPRING_DATASOURCE_USERNAME_PERMISSIONDB}
      - SPRING_DATASOURCE_PASSWORD=${SPRING_DATASOURCE_PASSWORD_PERMISSIONDB}
    depends_on:
      - permission-db
  permission-db:
    image: postgres:16
    container_name: permission-db
    environment:
      POSTGRES_DB: ${DB_PERMISSION_NAME}
      POSTGRES_USER: ${DB_PERMISSION_USER}
      POSTGRES_PASSWORD: ${DB_PERMISSION_PASSWORD}
    ports:
      - "5432:5432"


  snippet-service:
    image: ghcr.io/ingenieria-de-sistemas-123/snippet-service:dev
    container_name: snippet-service
    ports:
      - "8081:8080"
    environment:
      - SPRING_DATASOURCE_URL=${SPRING_DATASOURCE_URL_SNIPPET}
      - SPRING_DATASOURCE_USERNAME=${SPRING_DATASOURCE_USERNAME_SNIPPET}
      - SPRING_DATASOURCE_PASSWORD=${SPRING_DATASOURCE_PASSWORD_SNIPPET}
      - SPRING_PROFILES_ACTIVE=docker
      - LANGUAGE_BASE_URL=http://language-service:8080
    depends_on:
      - snippet-db

  snippet-db:
    image: postgres:16-alpine
    container_name: snippet-db
    environment:
      POSTGRES_DB: ${DB_SNIPPET_NAME}
      POSTGRES_USER: ${DB_SNIPPET_USERNAME}
      POSTGRES_PASSWORD: ${DB_SNIPPET_PASSWORD}
    ports:
      - "5433:5432"


  language-service:
    image: ghcr.io/ingenieria-de-sistemas-123/language-service:dev
    container_name: language-service
    ports:
      - "8082:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=docker
networks:
  default:
    driver: bridge